(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{8707:(e,r,t)=>{Promise.resolve().then(t.bind(t,7405))},7405:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>_});var s=t(5155),a=t(2115),n=t(9606),i=t(2679),o=t(4085),l=t(4839),d=t(5007),c=t(9134),u=t(1100),m=t(1563),f=t(9564),p=t(4213),h=t(2336);function x(e){let{form:r,disabled:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.z,{name:"email",render:e=>{let{field:r}=e;return(0,s.jsxs)(f.e,{children:[(0,s.jsx)(p.l,{children:"Email"}),(0,s.jsx)(u.M,{children:(0,s.jsx)(h.p,{...r,type:"email",placeholder:"your@email.com",disabled:t})})]})}}),(0,s.jsx)(m.z,{name:"confirmEmail",render:e=>{let{field:r}=e;return(0,s.jsxs)(f.e,{children:[(0,s.jsx)(p.l,{children:"Confirm Email"}),(0,s.jsx)(u.M,{children:(0,s.jsx)(h.p,{...r,type:"email",placeholder:"Confirm your email",disabled:t})})]})}}),(0,s.jsx)(m.z,{name:"password",render:e=>{let{field:r}=e;return(0,s.jsxs)(f.e,{children:[(0,s.jsx)(p.l,{children:"Password"}),(0,s.jsx)(u.M,{children:(0,s.jsx)(h.p,{...r,type:"password",placeholder:"••••••••",disabled:t})})]})}}),(0,s.jsx)(m.z,{name:"confirmPassword",render:e=>{let{field:r}=e;return(0,s.jsxs)(f.e,{children:[(0,s.jsx)(p.l,{children:"Confirm Password"}),(0,s.jsx)(u.M,{children:(0,s.jsx)(h.p,{...r,type:"password",placeholder:"••••••••",disabled:t})})]})}})]})}var g=t(2318);function j(e){let{form:r,disabled:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.z,{name:"firstName",render:e=>{let{field:r}=e;return(0,s.jsxs)(f.e,{children:[(0,s.jsx)(p.l,{children:"First Name"}),(0,s.jsx)(u.M,{children:(0,s.jsx)(h.p,{...r,placeholder:"John",disabled:t})}),(0,s.jsx)(g.C,{})]})}}),(0,s.jsx)(m.z,{name:"lastName",render:e=>{let{field:r}=e;return(0,s.jsxs)(f.e,{children:[(0,s.jsx)(p.l,{children:"Last Name"}),(0,s.jsx)(u.M,{children:(0,s.jsx)(h.p,{...r,placeholder:"Doe",disabled:t})}),(0,s.jsx)(g.C,{})]})}})]})}var v=t(2608);let y=["United States","United Kingdom","Canada","Australia","Germany","France","Spain","Italy","Japan","China","India","Brazil"];function b(e){let{form:r,disabled:t}=e;return(0,s.jsx)(n.xI,{control:r.control,name:"country",render:e=>{var a;let{field:n}=e;return(0,s.jsxs)(f.e,{children:[(0,s.jsx)(p.l,{children:"Country"}),(0,s.jsxs)(v.l6,{onValueChange:n.onChange,defaultValue:n.value,children:[(0,s.jsx)(u.M,{children:(0,s.jsx)(v.bq,{disabled:t,children:(0,s.jsx)(v.yv,{placeholder:"Select your country"})})}),(0,s.jsx)(v.gC,{children:y.map(e=>(0,s.jsx)(v.eb,{value:e,children:e},e))})]}),(0,s.jsx)(g.C,{children:null===(a=r.formState.errors.country)||void 0===a?void 0:a.message})]})}})}var w=t(3415);w.Ik({email:w.Yj().email("Invalid email address"),confirmEmail:w.Yj().email("Invalid email address"),password:w.Yj().min(6,"Password must be at least 6 characters"),confirmPassword:w.Yj().min(6,"Password must be at least 6 characters")}).refine(e=>e.email===e.confirmEmail,{message:"Emails don't match",path:["confirmEmail"]}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),w.Ik({firstName:w.Yj().min(2,"First name must be at least 2 characters"),lastName:w.Yj().min(2,"Last name must be at least 2 characters")}),w.Ik({country:w.Yj().min(1,"Please select your country")});let E=w.Ik({email:w.Yj().email("Invalid email address"),confirmEmail:w.Yj().email("Invalid email address"),password:w.Yj().min(6,"Password must be at least 6 characters"),confirmPassword:w.Yj().min(6,"Password must be at least 6 characters"),firstName:w.Yj().min(2,"First name must be at least 2 characters"),lastName:w.Yj().min(2,"Last name must be at least 2 characters"),country:w.Yj().min(1,"Please select your country")}).refine(e=>e.email===e.confirmEmail,{message:"Emails don't match",path:["confirmEmail"]}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});var I=t(5096),N=t(2382),S=t(6046);function _(){let[e,r]=(0,a.useState)(1),[t,u]=(0,a.useState)(!1),{toast:m}=(0,c.dj)(),f=(0,S.useRouter)(),p=(0,n.mN)({resolver:(0,i.u)(E),defaultValues:{email:"",confirmEmail:"",firstName:"",lastName:"",country:"",password:"",confirmPassword:""},mode:"onChange"}),h=async()=>{let r=!1;try{return 1===e?(await p.trigger(["email","confirmEmail","password","confirmPassword"]),r=!p.formState.errors.email&&!p.formState.errors.confirmEmail&&!p.formState.errors.password&&!p.formState.errors.confirmPassword):2===e?(await p.trigger(["firstName","lastName"]),r=!p.formState.errors.firstName&&!p.formState.errors.lastName):3===e&&(await p.trigger(["country"]),r=!p.formState.errors.country),r}catch(e){return console.error("Validation error:",e),!1}},g=async t=>{if(e<3){await h()&&r(e+1);return}if(await h()){u(!0);try{let e={uid:(await (0,N.WI)(t.email,t.password)).uid,email:t.email,firstName:t.firstName,lastName:t.lastName,country:t.country};await (0,I.k)(e),m({title:"Registration Successful!",description:"Welcome to Kingdom Runners! You can now log in to your account."}),p.reset(),f.push("/login")}catch(e){m({title:"Registration Failed",description:e instanceof Error?e.message:"Please try again later.",variant:"destructive"})}finally{u(!1)}}},v=async()=>{await h()&&r(e+1)};return(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)(d.Zp,{className:"max-w-xl mx-auto",children:[(0,s.jsx)(d.aR,{children:(0,s.jsx)(d.ZB,{className:"text-2xl text-center",children:"Join Kingdom Runners"})}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)(l.lV,{...p,onSubmit:p.handleSubmit(g),children:(0,s.jsxs)("div",{className:"space-y-6",children:[1===e&&(0,s.jsx)(x,{form:p}),2===e&&(0,s.jsx)(j,{form:p}),3===e&&(0,s.jsx)(b,{form:p}),(0,s.jsxs)("div",{className:"flex justify-between",children:[e>1&&(0,s.jsx)(o.$,{type:"button",onClick:()=>r(e-1),disabled:t,children:"Previous"}),e<3?(0,s.jsx)(o.$,{type:"button",onClick:v,disabled:t,children:"Next"}):(0,s.jsx)(o.$,{type:"submit",disabled:t,children:t?"Processing...":"Complete Registration"})]})]})})})]})})}},4085:(e,r,t)=>{"use strict";t.d(r,{$:()=>a});var s=t(5155);t(2115);let a=e=>{let{children:r,...t}=e;return(0,s.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2",...t,children:r})}},5007:(e,r,t)=>{"use strict";t.d(r,{BT:()=>o,Wu:()=>l,ZB:()=>i,Zp:()=>a,aR:()=>n});var s=t(5155);t(2115);let a=e=>{let{children:r,className:t,...a}=e;return(0,s.jsx)("div",{className:"rounded-md border shadow-sm ".concat(t),...a,children:r})},n=e=>{let{children:r,className:t,...a}=e;return(0,s.jsx)("div",{className:"px-4 py-3 border-b font-semibold ".concat(t),...a,children:r})},i=e=>{let{className:r,...t}=e;return(0,s.jsx)("h3",{className:"text-lg font-semibold ".concat(r),...t})},o=e=>{let{className:r,...t}=e;return(0,s.jsx)("p",{className:"text-sm text-muted-foreground ".concat(r),...t})},l=e=>{let{children:r,className:t,...a}=e;return(0,s.jsx)("div",{className:"p-4 ".concat(t),...a,children:r})}},4839:(e,r,t)=>{"use strict";t.d(r,{C5:()=>l.C,MJ:()=>o.M,eI:()=>n.e,lR:()=>i.l,lV:()=>d,zB:()=>a.z});var s=t(5155);t(2115);var a=t(1563),n=t(9564),i=t(4213),o=t(1100),l=t(2318);let d=e=>{let{children:r,onSubmit:t}=e;return(0,s.jsx)("form",{onSubmit:t,children:r})}},1100:(e,r,t)=>{"use strict";t.d(r,{M:()=>a});var s=t(5155);t(2115);let a=e=>{let{children:r,className:t}=e;return(0,s.jsx)("div",{className:t,children:r})}},1563:(e,r,t)=>{"use strict";t.d(r,{z:()=>l});var s=t(5155);t(2115);var a=t(5785),n=t(1100),i=t(2318),o=t(9606);let l=e=>{let{name:r,label:t,render:l}=e,{control:d}=(0,o.xW)();return(0,s.jsx)(o.xI,{name:r,control:d,render:e=>{var r;let{field:o,fieldState:d}=e;return(0,s.jsxs)("div",{children:[t&&(0,s.jsx)(a.J,{children:t}),(0,s.jsx)(n.M,{children:l({field:o})}),(0,s.jsx)(i.C,{children:null===(r=d.error)||void 0===r?void 0:r.message})]})}})}},9564:(e,r,t)=>{"use strict";t.d(r,{e:()=>a});var s=t(5155);t(2115);let a=e=>{let{children:r,className:t}=e;return(0,s.jsx)("div",{className:t,children:r})}},4213:(e,r,t)=>{"use strict";t.d(r,{l:()=>n});var s=t(5155);t(2115);var a=t(5785);let n=e=>{let{children:r,...t}=e;return(0,s.jsx)(a.J,{...t,children:r})}},2318:(e,r,t)=>{"use strict";t.d(r,{C:()=>n});var s=t(5155);t(2115);var a=t(9606);let n=e=>{var r;let{name:t,children:n,className:i}=e,{formState:{errors:o}}=(0,a.xW)(),l=t&&(null===(r=o[t])||void 0===r?void 0:r.message),d=l?String(l):n;return(0,s.jsx)("p",{className:i,children:d})}},2336:(e,r,t)=>{"use strict";t.d(r,{p:()=>a});var s=t(5155);let a=t(2115).forwardRef((e,r)=>{let{className:t,type:a,...n}=e;return(0,s.jsx)("input",{type:a,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",ref:r,...n})});a.displayName="Input"},5785:(e,r,t)=>{"use strict";t.d(r,{J:()=>d});var s=t(5155),a=t(2115),n=t(6195),i=t(1027),o=t(9602);let l=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.b,{ref:r,className:(0,o.cn)(l(),t),...a})});d.displayName=n.b.displayName},2608:(e,r,t)=>{"use strict";t.d(r,{l6:()=>o,gC:()=>d,eb:()=>c,bq:()=>l,yv:()=>u});var s=t(5155),a=t(2115),n=t(9602);let i=(0,t(7401).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),o=a.forwardRef((e,r)=>{let{className:t,children:a,...i}=e;return(0,s.jsx)("div",{className:(0,n.cn)("relative",t),ref:r,...i,children:a})});o.displayName="Select";let l=a.forwardRef((e,r)=>{let{className:t,children:a,...o}=e;return(0,s.jsxs)("button",{className:(0,n.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...o,children:[(0,s.jsx)(u,{}),(0,s.jsx)(i,{className:"ml-2 h-4 w-4 opacity-50"})]})});l.displayName="SelectTrigger";let d=a.forwardRef((e,r)=>{let{className:t,children:a,...i}=e;return(0,s.jsx)("div",{className:(0,n.cn)("absolute z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md",t),ref:r,...i,children:a})});d.displayName="SelectContent";let c=a.forwardRef((e,r)=>{let{className:t,children:a,value:i,...o}=e;return(0,s.jsxs)("div",{className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[highlighted]:bg-accent data-[highlighted]:text-accent-foreground",t),ref:r,...o,"data-value":i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"}),a]})});c.displayName="SelectItem";let u=a.forwardRef((e,r)=>{let{className:t,placeholder:a,children:i,...o}=e;return(0,s.jsx)("span",{className:(0,n.cn)("ml-2 block truncate",t),ref:r,...o,children:i||a})});u.displayName="SelectValue"},9134:(e,r,t)=>{"use strict";t.d(r,{dj:()=>m});var s=t(2115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let r=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,r)},o=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?i(t):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},l=[],d={toasts:[]};function c(e){d=o(d,e),l.forEach(e=>{e(d)})}function u(e){let{...r}=e,t=(a=(a+1)%Number.MAX_VALUE).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,r]=s.useState(d);return s.useEffect(()=>(l.push(r),()=>{let e=l.indexOf(r);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},2382:(e,r,t)=>{"use strict";t.d(r,{WI:()=>i,Lx:()=>o,CI:()=>l});var s=t(4565),a=t(9891);t(9911);let n=(0,s.xI)(a.y);async function i(e,r){try{return(await (0,s.eJ)(n,e,r)).user}catch(e){throw console.error("Error creating auth user:",e),Error(e.message||"Failed to create user")}}async function o(e,r){try{return(await (0,s.x9)(n,e,r)).user}catch(e){throw console.error("Error logging in:",e),Error(e.message||"Invalid email or password")}}async function l(){try{await (0,s.CI)(n)}catch(e){throw console.error("Error signing out:",e),Error(e.message||"Failed to sign out")}}},5096:(e,r,t)=>{"use strict";t.d(r,{k:()=>i,w:()=>n});var s=t(7058),a=t(9891);async function n(e){try{if(!e)throw Error("User ID is required");let r=(0,s.rJ)(a.db,"users"),t=(0,s.P)(r,(0,s._M)("uid","==",e)),n=await (0,s.GG)(t);if(n.empty)return null;let i=n.docs[0],o=i.data();return{id:i.id,...o,createdAt:o.createdAt.toDate()}}catch(e){if(console.error("Error getting user:",e),e instanceof Error)throw Error(e.message);throw Error("Failed to get user profile")}}async function i(e){try{if(await n(e.uid))throw Error("User profile already exists");let r={...e,totalDistance:0,totalPrayers:0,createdAt:s.Dc.now()};return{id:(await (0,s.gS)((0,s.rJ)(a.db,"users"),r)).id,...r,createdAt:new Date}}catch(e){if(console.error("Error creating user:",e),e instanceof Error)throw Error(e.message);throw Error("Failed to create user profile")}}},9911:(e,r,t)=>{"use strict";t.d(r,{C:()=>n});var s=t(2818);let a={apiKey:"AIzaSyCopx5Hk7QK3JkyrVU9IWYJuERPn7vH43E",projectId:"kingdomrunnersdv1",storageBucket:"kingdomrunnersdv1.firebasestorage.app",messagingSenderId:"626559745548",appId:"1:626559745548:web:3e2f5d7498f7e3beb1f829",measurementId:"G-0G8N8DZWHW"},n={apiKey:s.env.NEXT_PUBLIC_FIREBASE_API_KEY||a.apiKey,authDomain:s.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"krstaging.netlify.app",projectId:s.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||a.projectId,storageBucket:s.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||a.storageBucket,messagingSenderId:s.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID||a.messagingSenderId,appId:s.env.NEXT_PUBLIC_FIREBASE_APP_ID||a.appId,measurementId:s.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID||a.measurementId}},9891:(e,r,t)=>{"use strict";t.d(r,{db:()=>c,j:()=>d,storage:()=>u,y:()=>l});var s=t(9904),a=t(7058),n=t(4565),i=t(333),o=t(9911);let l=0===(0,s.Dk)().length?(0,s.Wp)(o.C):(0,s.Dk)()[0],d=(0,n.xI)(l),c=(0,a.aU)(l),u=(0,i.c7)(l);(0,n.oM)(d,n.F0).catch(e=>{console.error("Error setting auth persistence:",e)}),(0,a.ol)(c).catch(e=>{"failed-precondition"===e.code?console.warn("Multiple tabs open, persistence enabled in first tab only"):"unimplemented"===e.code&&console.warn("Browser does not support persistence")})},9602:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var s=t(3463),a=t(9795);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}},6046:(e,r,t)=>{"use strict";var s=t(6658);t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})}},e=>{var r=r=>e(e.s=r);e.O(0,[992,794,575,525,942,441,517,358],()=>r(8707)),_N_E=e.O()}]);